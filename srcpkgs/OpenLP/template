# Template file for 'OpenLP'
pkgname=OpenLP
version=3.0.0
revision=1
create_wrksrc=yes
build_style=python3-module
make_check_args="--deselect tests/openlp_core/common/test_init.py::test_extension_loader_import_error
 --deselect tests/openlp_core/common/test_init.py::test_extension_loader_os_error
 --deselect tests/openlp_core/lib/test_serviceitem.py::test_to_dict_text_item
 --deselect tests/openlp_core/lib/test_serviceitem.py::test_to_dict_image_item
 --deselect tests/openlp_core/lib/test_serviceitem.py::test_to_dict_presentation_item
 --deselect tests/openlp_core/lib/test_lib.py::test_get_text_file_string_read_error
 --deselect tests/openlp_core/lib/test_lib.py::test_create_thumb_invalid_size"
hostmakedepends="python3-setuptools qt5-host-tools"
depends="python3-alembic python3-appdirs python3-BeautifulSoup4 python3-chardet
 python3-dbus python3-distro python3-Flask python3-Flask-Cors python3-lxml
 python3-Mako python3-Pillow python3-pymediainfo python3-PyQt5
 python3-PyQt5-multimedia python3-PyQt5-webengine python3-vlc python3-qrcode
 python3-QtAwesome python3-requests python3-SQLAlchemy python3-waitress
 python3-WebOb python3-websockets python3-zeroconf"
checkdepends="python3-pytest-qt xvfb-run ${depends}"
short_desc="Free Worship Presentation Software for your Church"
maintainer="Piotr WÃ³jcik <chocimier@tlen.pl>"
license="GPL-3.0-or-later"
homepage="https://openlp.org/"
distfiles="https://get.openlp.org/${version}/OpenLP-${version}.tar.gz"
checksum=6c28bfda7896b9f5fe8346def1f318d0111b005fc81b0aa6c2bee1c366d5a6e4
make_check_pre="env -u QT_QPA_PLATFORM xvfb-run"

post_install() {
	vinstall resources/openlp.desktop 644 usr/share/applications
	vmkdir usr/share/openlp/i18n
	cd resources/i18n
	for i in *.ts; do
		lconvert -i "${i}" -o "${DESTDIR}/usr/share/openlp/i18n/${i%ts}qm"
	done
}
